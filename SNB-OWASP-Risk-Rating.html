<!DOCTYPE html>

<html lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>Snoopbees OWASP Risk Calculator</title>
<script src="https://cdn.tailwindcss.com"></script>
<style>
        body {
            font-family: 'Inter', sans-serif;
        }
    </style>
</head>
<body class="bg-[#0D1117] text-white min-h-screen py-10 px-6">
<div class="max-w-6xl mx-auto">
<!-- Header -->
<div class="flex justify-between items-center mb-8 border-b border-gray-700 pb-2">
<h1 class="text-xl md:text-2xl font-bold text-yellow-400">ğŸ SNOOPBEES | OWASP Risk Rating Calculator</h1>
<div>
<button class="bg-gray-700 px-3 py-1 rounded hover:bg-gray-600 mr-2" onclick="setLang('en')">EN</button>
<button class="bg-gray-700 px-3 py-1 rounded hover:bg-gray-600" onclick="setLang('th')">TH</button>
</div>
</div>
<!-- Threat Agent & Vulnerability -->
<div class="border-2 border-gray-800 bg-gray-900 rounded-xl p-3 mb-2">
<h2 class="text-lg font-semibold text-blue-400 mb-3">LIKELIHOOD</h2>
<div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-2" id="tr_likelihood">
<section class="bg-gray-800 p-4 rounded-xl">
<h2 class="text-lg font-semibold text-blue-400 mb-3">Threat Agent</h2>
<div class="space-y-2 text-sm">
<div class="flex justify-between items-center">
<label>ğŸ§  Skill Level</label>
<select class="bg-gray-700 text-black rounded px-2 py-1" id="skill-level">
<option value="0">0</option>
<option selected="" value="1">1 - No technical skills</option>
<option value="2">2</option>
<option value="3">3 - Some technical skills</option>
<option value="4">4</option>
<option value="5">5 - Advanced computer user</option>
<option value="6">6 - Network and programming skills</option>
<option value="7">7</option>
<option value="8">8</option>
<option value="9">9 - Security penetration skills</option>
</select>
</div>
<div class="flex justify-between items-center">
<label>ğŸ¯ Motive</label>
<select class="bg-gray-700 text-black rounded px-2 py-1" id="motive">
<option value="0">0</option>
<option selected="" value="1">1 - Low or no reward</option>
<option value="2">2</option>
<option value="3">3</option>
<option value="4">4 - Possible reward</option>
<option value="5">5</option>
<option value="6">6</option>
<option value="7">7</option>
<option value="8">8</option>
<option value="9">9 - High reward</option>
</select>
</div>
<div class="flex justify-between items-center">
<label>ğŸ§± Opportunity</label>
<select class="bg-gray-700 text-black rounded px-2 py-1" id="opportunity">
<option selected="" value="0">0 - Full access or expensive resources required</option>
<option value="1">1</option>
<option value="2">2</option>
<option value="3">3</option>
<option value="4">4 - Special access or resources required</option>
<option value="5">5</option>
<option value="6">6</option>
<option value="7">7 - Some access or resources required</option>
<option value="8">8</option>
<option value="9">9 - No access or resources required</option>
</select>
</div>
<div class="flex justify-between items-center">
<label>ğŸ‘¥ Size</label>
<select class="bg-gray-700 text-black rounded px-2 py-1" id="size">
<option value="0">0</option>
<option value="1">1</option>
<option selected="" value="2">2 - Developers, system administrators</option>
<option value="3">3</option>
<option value="4">4 - Intranet users</option>
<option value="5">5 - Partners</option>
<option value="6">6 - Authenticated users</option>
<option value="7">7</option>
<option value="8">8</option>
<option value="9">9 - Anonymous Internet users</option>
</select>
</div>
</div>
</section>
<section class="bg-gray-800 p-4 rounded-xl">
<h2 class="text-lg font-semibold text-blue-400 mb-3">Vulnerability</h2>
<div class="space-y-2 text-sm">
<div class="flex justify-between items-center">
<label>ğŸ” Ease of Discovery</label>
<select class="bg-gray-700 text-black rounded px-2 py-1" id="ease-of-discovery">
<option value="0">0</option>
<option selected="" value="1">1 - Practically impossible</option>
<option value="2">2</option>
<option value="3">3 - Difficult</option>
<option value="4">4</option>
<option value="5">5</option>
<option value="6">6</option>
<option value="7">7 - Easy</option>
<option value="8">8</option>
<option value="9">9 - Automated tools available</option>
</select>
</div>
<div class="flex justify-between items-center">
<label>ğŸ¯ Ease of Exploit</label>
<select class="bg-gray-700 text-black rounded px-2 py-1" id="ease-of-exploit">
<option value="0">0</option>
<option selected="" value="1">1 - Theoretical</option>
<option value="2">2</option>
<option value="3">3 - Difficult</option>
<option value="4">4</option>
<option value="5">5 - Easy</option>
<option value="6">6</option>
<option value="7">7</option>
<option value="8">8</option>
<option value="9">9 - Automated tools available</option>
</select>
</div>
<div class="flex justify-between items-center">
<label>â“ Awareness</label>
<select class="bg-gray-700 text-black rounded px-2 py-1" id="awareness">
<option value="0">0</option>
<option selected="" value="1">1 - Unknown</option>
<option value="2">2</option>
<option value="3">3</option>
<option value="4">4 - Hidden</option>
<option value="5">5</option>
<option value="6">6 - Obvious</option>
<option value="7">7</option>
<option value="8">8</option>
<option value="9">9 - Public knowledge</option>
</select>
</div>
<div class="flex justify-between items-center">
<label>ğŸ›¡ Intrusion Detect</label>
<select class="bg-gray-700 text-black rounded px-2 py-1" id="intrusion-detect">
<option value="0">0</option>
<option selected="" value="1">1 - Active detection in application</option>
<option value="2">2</option>
<option value="3">3 - Logged and reviewed</option>
<option value="4">4</option>
<option value="5">5</option>
<option value="6">6</option>
<option value="7">7</option>
<option value="8">8 - Logged without review</option>
<option value="9">9 - Not logged</option>
</select>
</div>
</div>
</section>
</div>
</div>
<!-- Impact -->
<div class="border-2 border-gray-800 bg-gray-900 rounded-xl p-3 mb-2">
<h2 class="text-lg font-semibold text-blue-400 mb-3">IMPACT</h2>
<div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-2">
<section class="bg-gray-800 p-4 rounded-xl">
<h2 class="text-lg font-semibold text-green-400 mb-3">Technical Impact</h2>
<div class="space-y-2 text-sm" id="tr_techimpact">
<div class="flex justify-between items-center">
<label>âœ… Loss of Confidentiality</label>
<select class="bg-gray-700 text-black rounded px-2 py-1 truncate w-full max-w-xs" id="confidentiality">
<option value="0">0</option>
<option value="1">1</option>
<option selected="" value="2">2 - Minimal non-sensitive data disclosed</option>
<option value="3">3</option>
<option value="4">4</option>
<option value="5">5</option>
<option value="6">6 - Minimal critical data disclosed, extensive non-sensitive data
                                    disclosed</option>
<option value="7">7 - Extensive critical data disclosed</option>
<option value="8">8</option>
<option value="9">9 - All data disclosed</option>
</select>
</div>
<div class="flex justify-between items-center">
<label>âœ… Loss of Integrity</label>
<select class="bg-gray-700 text-black rounded px-2 py-1" id="integrity">
<option value="0">0</option>
<option selected="" value="1">1 - Minimal slightly corrupt data</option>
<option value="2">2</option>
<option value="3">3 - Minimal seriously corrupt data</option>
<option value="4">4</option>
<option value="5">5 - Extensive slightly corrupt data</option>
<option value="6">6</option>
<option value="7">7 - Extensive seriously corrupt data</option>
<option value="8">8</option>
<option value="9">9 - All data totally corrupt</option>
</select>
</div>
<div class="flex justify-between items-center">
<label>âœ… Loss of Availability</label>
<select class="bg-gray-700 text-black rounded px-2 py-1 truncate w-full max-w-xs" id="availability">
<option value="0">0</option>
<option selected="" value="1">1 - Minimal secondary services interrupted</option>
<option value="2">2</option>
<option value="3">3</option>
<option value="4">4</option>
<option value="5">5 - Minimal primary services interrupted, extensive secondary services interrupted</option>
<option value="6">6</option>
<option value="7">7 - Extensive primary services interrupted</option>
<option value="8">8</option>
<option value="9">9 - All services completely lost</option>
</select>
</div>
<div class="flex justify-between items-center">
<label>âœ… Loss of Accountability</label>
<select class="bg-gray-700 text-black rounded px-2 py-1" id="accountability">
<option value="0">0</option>
<option selected="" value="1">1 - Fully traceable</option>
<option value="2">2</option>
<option value="3">3</option>
<option value="4">4</option>
<option value="5">5</option>
<option value="6">6</option>
<option value="7">7 - Possibly traceable</option>
<option value="8">8</option>
<option value="9">9 - Completely anonymous</option>
</select>
</div>
</div>
</section>
<section class="bg-gray-800 p-4 rounded-xl">
<h2 class="text-lg font-semibold text-green-400 mb-3">Business Impact</h2>
<div class="space-y-2 text-sm" id="tr_busiimpact">
<div class="flex justify-between items-center">
<label>ğŸ’° Financial Damage</label>
<select class="bg-gray-700 text-black rounded px-2 py-1" id="financial-damage">
<option value="0">0</option>
<option selected="" value="1">1 - Less than the cost to fix the vulnerability</option>
<option value="2">2</option>
<option value="3">3 - Minor effect on annual profit</option>
<option value="4">4</option>
<option value="5">5</option>
<option value="6">6</option>
<option value="7">7 - Significant effect on annual profit</option>
<option value="8">8</option>
<option value="9">9 - Bankruptcy</option>
</select>
</div>
<div class="flex justify-between items-center">
<label>ğŸ“‰ Reputation Damage</label>
<select class="bg-gray-700 text-black rounded px-2 py-1" id="reputation">
<option value="0">0</option>
<option selected="" value="1">1 - Minimal damage</option>
<option value="2">2</option>
<option value="3">3</option>
<option value="4">4 - Loss of major accounts</option>
<option value="5">5 - Loss of goodwill</option>
<option value="6">6</option>
<option value="7">7</option>
<option value="8">8</option>
<option value="9">9 - Brand damage</option>
</select>
</div>
<div class="flex justify-between items-center">
<label>âš–ï¸ Non-Compliance</label>
<select class="bg-gray-700 text-black rounded px-2 py-1" id="compliance">
<option value="0">0</option>
<option value="1">1</option>
<option selected="" value="2">2 - Minor violation</option>
<option value="3">3</option>
<option value="4">4</option>
<option value="5">5 - Clear violation</option>
<option value="6">6</option>
<option value="7">7 - High profile violation</option>
<option value="8">8</option>
<option value="9">9</option>
</select>
</div>
<div class="flex justify-between items-center">
<label>ğŸ” Privacy Violation</label>
<select class="bg-gray-700 text-black rounded px-2 py-1" id="privacy">
<option value="0">0</option>
<option value="1">1</option>
<option value="2">2</option>
<option selected="" value="3">3 - One individual</option>
<option value="4">4</option>
<option value="5">5 - Hundreds of people</option>
<option value="6">6</option>
<option value="7">7 - Thousands of people</option>
<option value="8">8</option>
<option value="9">9 - Millions of people</option>
</select>
</div>
</div>
</section>
</div>
<!-- Adjust -->
 <span class="grid grid-cols-3 gap-4">
  <span class="text-lg font-semibold text-green-400 text-left">Technical Impact</span>
  <div class="text-lg font-semibold text-blue-400 text-center">
    Adjust Weight
    <p class="text-green-300 font-bold text-xl">
      <span id="adjustScore">0%</span>
    </p>
  </div>
  <span class="text-lg font-semibold text-green-400 text-right">Business Impact</span>
 </span>
<!-- <div class="text-lg font-semibold text-blue-400 flex justify-center">
  <label>Adjust Weigth</label>
</div> -->
<input type="range" min="0" max="100" step="10" value="0" class="w-full bg-transparent cursor-pointer appearance-none disabled:opacity-50 disabled:pointer-events-none focus:outline-hidden
  [&::-webkit-slider-thumb]:w-2.5
  [&::-webkit-slider-thumb]:h-2.5
  [&::-webkit-slider-thumb]:-mt-0.5
  [&::-webkit-slider-thumb]:appearance-none
  [&::-webkit-slider-thumb]:bg-white
  [&::-webkit-slider-thumb]:shadow-[0_0_0_4px_rgba(37,99,235,1)]
  [&::-webkit-slider-thumb]:rounded-full
  [&::-webkit-slider-thumb]:transition-all
  [&::-webkit-slider-thumb]:duration-150
  [&::-webkit-slider-thumb]:ease-in-out
  dark:[&::-webkit-slider-thumb]:bg-neutral-700

  [&::-moz-range-thumb]:w-2.5
  [&::-moz-range-thumb]:h-2.5
  [&::-moz-range-thumb]:appearance-none
  [&::-moz-range-thumb]:bg-white
  [&::-moz-range-thumb]:border-4
  [&::-moz-range-thumb]:border-blue-600
  [&::-moz-range-thumb]:rounded-full
  [&::-moz-range-thumb]:transition-all
  [&::-moz-range-thumb]:duration-150
  [&::-moz-range-thumb]:ease-in-out

  [&::-webkit-slider-runnable-track]:w-full
  [&::-webkit-slider-runnable-track]:h-2
  [&::-webkit-slider-runnable-track]:bg-gray-100
  [&::-webkit-slider-runnable-track]:rounded-full
  dark:[&::-webkit-slider-runnable-track]:bg-neutral-700

  [&::-moz-range-track]:w-full
  [&::-moz-range-track]:h-2
  [&::-moz-range-track]:bg-gray-100
  [&::-moz-range-track]:rounded-full" id="adjust" aria-orientation="horizontal">
</div>
<!-- Score Section -->
<section class="bg-gray-800 mt-8 p-6 rounded-xl shadow-lg text-center">
<h2 class="text-lg font-semibold text-yellow-400 mb-4">ğŸ“Š Final Risk Score</h2>
<div class="flex justify-center items-center mb-4 gap-6">
<div class="text-sm">
<p class="text-gray-300">Likelihood</p>
<p class="font-bold text-xl" id="likelihood">3.9</p> <p id="likelihood-label">LOW</p>
</div>
<div class="text-sm">
<p class="text-gray-300">Technical Impact</p>
<p class="text-yellow-300 font-bold text-xl" id="techimpact">5.0</p> <p id="techimpact-label">LOW</p>
</div>
<div class="text-sm">
<p class="text-gray-300">Business Impact</p>
<p class="text-green-300 font-bold text-xl" id="busiimpact">1.8</p> <p id="busiimpact-label">LOW</p>
</div>
</div>
<p class="text-2xl font-bold text-black " id="risk">MEDIUM</p>
<div class="text-gray-400 break-all" id="vector">Vector: </div>
<button id="copyVectorBtn" class="bg-gray-700 px-2 py-1 rounded hover:bg-gray-600 text-xs">ğŸ“‹ Copy</button>
</section>
</div>
<script>
    const translations = {
      en: {
        "SNOOPBEES OWASP Risk Rating Calculator": "SNOOPBEES OWASP Risk Rating Calculator",
        "Likelihood": "Likelihood",
        "Threat Agent Factors": "Threat Agent Factors",
        "Vulnerability Factors": "Vulnerability Factors",
        "Impact": "Impact",
        "Technical Impact": "Technical Impact",
        "Business Impact": "Business Impact",
        "Intermediate": "Intermediate",
        "Final Score": "Final Score",
        "Adjust score": "Adjust score",
        "Risk": "Risk",
        "ğŸ§  Skill Level": "ğŸ§  Skill Level",
        "ğŸ¯ Motive": "ğŸ¯ Motive",
        "ğŸ§± Opportunity": "ğŸ§± Opportunity",
        "ğŸ‘¥ Size": "ğŸ‘¥ Size",
        "ğŸ” Ease of Discovery": "ğŸ” Ease of Discovery",
        "ğŸ¯ Ease of Exploit": "ğŸ¯ Ease of Exploit",
        "â“ Awareness": "â“ Awareness",
        "ğŸ›¡ Intrusion Detection": "ğŸ›¡ Intrusion Detection",
        "âœ… Loss of Confidentiality": "âœ… Loss of Confidentiality",
        "âœ… Loss of Integrity": "âœ… Loss of Integrity",
        "âœ… Loss of Availability": "âœ… Loss of Availability",
        "âœ… Loss of Accountability": "âœ… Loss of Accountability",
        "ğŸ’° Financial Damage": "ğŸ’° Financial Damage",
        "ğŸ“‰ Reputation Damage": "ğŸ“‰ Reputation Damage",
        "âš–ï¸ Non-Compliance": "âš–ï¸ Non-Compliance",
        "ğŸ” Privacy Violation": "ğŸ” Privacy Violation",
        // Add dropdown options as keys for completeness (not used for en->th)
        //Skill Level
        "1 - Security penetration skills": "1 - Security penetration skills",
        "3 - Network and programming skills": "3 - Network and programming skills",
        "5 - Advanced computer user": "5 - Advanced computer user",
        "6 - Some technical skills": "6 - Some technical skills",
        "9 - No technical skills": "9 - No technical skills",
        //Motive
        "1 - Low or no reward": "1 - Low or no reward",
        "4 - Possible reward": "4 - Possible reward",
        "9 - High reward": "9 - High reward",
        //Opportunity
        "0 - Full access or expensive resources required": "0 - Full access or expensive resources required",
        "4 - Special access or resources required": "4 - Special access or resources required",
        "7 - Some access or resources required": "7 - Some access or resources required",
        "9 - No access or resources required": "9 - No access or resources required",
        //Size
        "2 - Developers, system administrators": "2 - Developers, system administrators",
        "4 - Intranet users": "4 - Intranet users",
        "5 - Partners": "5 - Partners",
        "6 - Authenticated users": "6 - Authenticated users",
        "9 - Anonymous Internet users": "9 - Anonymous Internet users",
        //Ease of Discovery
        "1 - Practically impossible": "1 - Practically impossible",
        "3 - Difficult": "3 - Difficult",
        "7 - Easy": "7 - Easy",
        "9 - Automated tools available": "9 - Automated tools available",
        //Ease of Exploit
        "1 - Theoretical": "1 - Theoretical",
        "3 - Difficult": "3 - Difficult",
        "5 - Easy": "5 - Easy",
        "9 - Automated tools available": "9 - Automated tools available",
        //Awareness
        "1 - Unknown": "1 - Unknown",
        "4 - Hidden": "4 - Hidden",
        "6 - Obvious": "6 - Obvious",
        "9 - Public knowledge": "9 - Public knowledge",
        //Intrusion Detection
        "1 - Active detection in application": "1 - Active detection in application",
        "3 - Logged and reviewed": "3 - Logged and reviewed",
        "8 - Logged without review": "8 - Logged without review",
        "9 - Not logged": "9 - Not logged",
        //Loss of Confidentiality
        "2 - Minimal non-sensitive data disclosed": "2 - Minimal non-sensitive data disclosed",
        "6 - Minimal critical data disclosed, extensive non-sensitive data disclosed": "6 - Minimal critical data disclosed, extensive non-sensitive data disclosed",
        "7 - Extensive critical data disclosed": "7 - Extensive critical data disclosed",
        "9 - All data disclosed": "9 - All data disclosed",
        //Loss of Integrity
        "1 - Minimal slightly corrupt data": "1 - Minimal slightly corrupt data",
        "3 - Minimal seriously corrupt data": "3 - Minimal seriously corrupt data",
        "5 - Extensive slightly corrupt data": "5 - Extensive slightly corrupt data",
        "7 - Extensive seriously corrupt data": "7- Extensive seriously corrupt data",
        "9 - All data totally corrupt": "9 - All data totally corrupt",
        //Loss of Availability
        "1 - Minimal secondary services interrupted": "1 - Minimal secondary services interrupted",
        "5 - Minimal primary services interrupted, extensive secondary services interrupted": "5 - Minimal primary services interrupted, extensive secondary services interrupted",
        "7 - Extensive primary services interrupted": "7 - Extensive primary services interrupted",
        "9 - All services completely lost": "9 - All services completely lost",
        //Loss of Accountability
        "1 - Fully traceable": "1 - Fully traceable",
        "7 - Possibly traceable": "7 - Possibly traceable",
        "9 - Completely anonymous": "9 - Completely anonymous",
        //Financial Damage
        "1 - Less than the cost to fix the vulnerability": "1 - Less than the cost to fix the vulnerability",
        "3 - Minor effect on annual profit": "3 - Minor effect on annual profit",
        "7 - Significant effect on annual profit": "7 - Significant effect on annual profit",
        "9 - Bankruptcy": "9 - Bankruptcy",
        //Reputation Damage
        "1 - Minimal damage": "1 - Minimal damage",
        "4 - Loss of major accounts": "4 - Loss of major accounts",
        "5 - Loss of goodwill": "5 - Loss of goodwill",
        "9 - Brand damage": "9 - Brand damage",
        //"Non-Compliance
        "2 - Minor violation": "2 - Minor violation",
        "5 - Clear violation": "5 - Clear violation",
        "7 - High profile violation": "7 - High profile violation",
        //Privacy Violation
        "3 - One individual": "3 - One individual",
        "5 - Hundreds of people": "5 - Hundreds of people",
        "7 - Thousands of people": "7 - Thousands of people",
        "9 - Millions of people": "9 - Millions of people"
      },
      th: {
        "SNOOPBEES OWASP Risk Rating Calculator": "à¹€à¸„à¸£à¸·à¹ˆà¸­à¸‡à¸¡à¸·à¸­à¸„à¸³à¸™à¸§à¸“à¸„à¸§à¸²à¸¡à¹€à¸ªà¸µà¹ˆà¸¢à¸‡ OWASP à¹‚à¸”à¸¢ SNOOPBEES",
        "Likelihood": "à¸„à¸§à¸²à¸¡à¹€à¸›à¹‡à¸™à¹„à¸›à¹„à¸”à¹‰",
        "Threat Agent Factors": "à¸›à¸±à¸ˆà¸ˆà¸±à¸¢à¸‚à¸­à¸‡à¸œà¸¹à¹‰à¹‚à¸ˆà¸¡à¸•à¸µ",
        "Vulnerability Factors": "à¸›à¸±à¸ˆà¸ˆà¸±à¸¢à¸‚à¸­à¸‡à¸Šà¹ˆà¸­à¸‡à¹‚à¸«à¸§à¹ˆ",
        "Impact": "à¸œà¸¥à¸à¸£à¸°à¸—à¸š",
        "Technical Impact": "à¸œà¸¥à¸à¸£à¸°à¸—à¸šà¸—à¸²à¸‡à¹€à¸—à¸„à¸™à¸´à¸„",
        "Business Impact": "à¸œà¸¥à¸à¸£à¸°à¸—à¸šà¸—à¸²à¸‡à¸˜à¸¸à¸£à¸à¸´à¸ˆ",
        "Intermediate": "à¸„à¸°à¹à¸™à¸™à¸£à¸°à¸”à¸±à¸šà¸à¸¥à¸²à¸‡",
        "Final Score": "à¸„à¸°à¹à¸™à¸™à¸ªà¸¸à¸”à¸—à¹‰à¸²à¸¢",
        "Adjust score": "à¸›à¸£à¸±à¸šà¸„à¸°à¹à¸™à¸™",
        "Risk": "à¸„à¸§à¸²à¸¡à¹€à¸ªà¸µà¹ˆà¸¢à¸‡",
        "ğŸ§  Skill Level": "ğŸ§  à¸—à¸±à¸à¸©à¸°à¸‚à¸­à¸‡à¸œà¸¹à¹‰à¹‚à¸ˆà¸¡à¸•à¸µ",
        "ğŸ¯ Motive": "ğŸ¯ à¹à¸£à¸‡à¸ˆà¸¹à¸‡à¹ƒà¸ˆ",
        "ğŸ§± Opportunity": "ğŸ§± à¹‚à¸­à¸à¸²à¸ª",
        "ğŸ‘¥ Size": "ğŸ‘¥ à¸‚à¸™à¸²à¸”à¸à¸¥à¸¸à¹ˆà¸¡à¸œà¸¹à¹‰à¹‚à¸ˆà¸¡à¸•à¸µ",
        "ğŸ” Ease of Discovery": "ğŸ” à¸„à¸§à¸²à¸¡à¸‡à¹ˆà¸²à¸¢à¹ƒà¸™à¸à¸²à¸£à¸„à¹‰à¸™à¸à¸šà¸Šà¹ˆà¸­à¸‡à¹‚à¸«à¸§à¹ˆ",
        "ğŸ¯ Ease of Exploit": "ğŸ¯ à¸„à¸§à¸²à¸¡à¸‡à¹ˆà¸²à¸¢à¹ƒà¸™à¸à¸²à¸£à¹‚à¸ˆà¸¡à¸•à¸µà¸Šà¹ˆà¸­à¸‡à¹‚à¸«à¸§à¹ˆ",
        "â“ Awareness": "â“ à¸à¸²à¸£à¸£à¸±à¸šà¸£à¸¹à¹‰à¸Šà¹ˆà¸­à¸‡à¹‚à¸«à¸§à¹ˆ",
        "ğŸ›¡ Intrusion Detection": "ğŸ›¡ à¸à¸²à¸£à¸•à¸£à¸§à¸ˆà¸ˆà¸±à¸šà¸à¸²à¸£à¸šà¸¸à¸à¸£à¸¸à¸",
        "âœ… Loss of Confidentiality": "âœ… à¸à¸²à¸£à¸ªà¸¹à¸à¹€à¸ªà¸µà¸¢à¸„à¸§à¸²à¸¡à¸¥à¸±à¸š",
        "âœ… Loss of Integrity": "âœ… à¸à¸²à¸£à¸ªà¸¹à¸à¹€à¸ªà¸µà¸¢à¸„à¸§à¸²à¸¡à¸–à¸¹à¸à¸•à¹‰à¸­à¸‡",
        "âœ… Loss of Availability": "âœ… à¸à¸²à¸£à¸ªà¸¹à¸à¹€à¸ªà¸µà¸¢à¸„à¸§à¸²à¸¡à¸à¸£à¹‰à¸­à¸¡à¹ƒà¸Šà¹‰à¸‡à¸²à¸™",
        "âœ… Loss of Accountability": "âœ… à¸à¸²à¸£à¸ªà¸¹à¸à¹€à¸ªà¸µà¸¢à¸à¸²à¸£à¸•à¸´à¸”à¸•à¸²à¸¡",
        "ğŸ’° Financial Damage": "ğŸ’° à¸„à¸§à¸²à¸¡à¹€à¸ªà¸µà¸¢à¸«à¸²à¸¢à¸—à¸²à¸‡à¸à¸²à¸£à¹€à¸‡à¸´à¸™",
        "ğŸ“‰ Reputation Damage": "ğŸ“‰ à¸„à¸§à¸²à¸¡à¹€à¸ªà¸µà¸¢à¸«à¸²à¸¢à¸•à¹ˆà¸­à¸Šà¸·à¹ˆà¸­à¹€à¸ªà¸µà¸¢à¸‡",
        "âš–ï¸ Non-Compliance": "âš–ï¸ à¸à¸²à¸£à¹„à¸¡à¹ˆà¸›à¸à¸´à¸šà¸±à¸•à¸´à¸•à¸²à¸¡à¸‚à¹‰à¸­à¸à¸³à¸«à¸™à¸”",
        "ğŸ” Privacy Violation": "ğŸ” à¸à¸²à¸£à¸¥à¸°à¹€à¸¡à¸´à¸”à¸„à¸§à¸²à¸¡à¹€à¸›à¹‡à¸™à¸ªà¹ˆà¸§à¸™à¸•à¸±à¸§",
        // Dropdown option translations:
        //Skill Level
        "1 - Security penetration skills": "1 - à¸¡à¸µà¸—à¸±à¸à¸©à¸°à¸”à¹‰à¸²à¸™à¸à¸²à¸£à¸—à¸”à¸ªà¸­à¸šà¸„à¸§à¸²à¸¡à¸›à¸¥à¸­à¸”à¸ à¸±à¸¢",
        "3 - Network and programming skills": "3 - à¸¡à¸µà¸—à¸±à¸à¸©à¸°à¸”à¹‰à¸²à¸™ Network à¹à¸¥à¸° programming",
        "5 - Advanced computer user": "5 - à¸¡à¸µà¸—à¸±à¸à¸©à¸°à¹ƒà¸™à¸à¸²à¸£à¹ƒà¸Šà¹‰à¸‡à¸²à¸™ Computer à¸ªà¸¹à¸‡",
        "6 - Some technical skills": "6 - à¸¡à¸µà¸—à¸±à¸à¸©à¸°à¸šà¸²à¸‡à¸ªà¹ˆà¸§à¸™",
        "9 - No technical skills": "9 - à¹„à¸¡à¹ˆà¸ˆà¸³à¹€à¸›à¹‡à¸™à¸•à¹‰à¸­à¸‡à¸¡à¸µà¸—à¸±à¸à¸©à¸°",
        //Motive
        "1 - Low or no reward": "1 - à¸œà¸¥à¸•à¸­à¸šà¹à¸—à¸™à¸™à¹‰à¸­à¸¢à¸«à¸£à¸·à¸­à¹„à¸¡à¹ˆà¸¡à¸µà¹€à¸¥à¸¢",
        "4 - Possible reward": "4 - à¸„à¹ˆà¸­à¸™à¸‚à¹‰à¸²à¸‡à¹„à¸”à¹‰à¸£à¸±à¸šà¸œà¸¥à¸•à¸­à¸šà¹à¸—à¸™",
        "9 - High reward": "9 - à¸œà¸¥à¸•à¸­à¸šà¹à¸—à¸™à¸ªà¸¹à¸‡",
        //Opportunity
        "0 - Full access or expensive resources required": "0 - à¸•à¹‰à¸­à¸‡à¸à¸²à¸£à¸ªà¸´à¸—à¸˜à¸´à¹Œà¹€à¸‚à¹‰à¸²à¸–à¸¶à¸‡à¹€à¸•à¹‡à¸¡à¸£à¸¹à¸›à¹à¸šà¸šà¸«à¸£à¸·à¸­à¸—à¸£à¸±à¸à¸¢à¸²à¸à¸£à¸—à¸µà¹ˆà¸¡à¸µà¸„à¹ˆà¸²à¹ƒà¸Šà¹‰à¸ˆà¹ˆà¸²à¸¢à¸ªà¸¹à¸‡",
        "4 - Special access or resources required": "4 - à¸•à¹‰à¸­à¸‡à¸à¸²à¸£à¸ªà¸´à¸—à¸˜à¸´à¹Œà¹€à¸‚à¹‰à¸²à¸–à¸¶à¸‡à¸«à¸£à¸·à¸­à¸—à¸£à¸±à¸à¸¢à¸²à¸à¸£",
        "7 - Some access or resources required": "7 - à¸•à¹‰à¸­à¸‡à¸à¸²à¸£à¸ªà¸´à¸—à¸˜à¸´à¹Œà¹€à¸‚à¹‰à¸²à¸–à¸¶à¸‡à¸«à¸£à¸·à¸­à¸—à¸£à¸±à¸à¸¢à¸²à¸à¸£à¹€à¸¥à¹‡à¸à¸™à¹‰à¸­à¸¢",
        "9 - No access or resources required": "9 - à¹„à¸¡à¹ˆà¸•à¹‰à¸­à¸‡à¸à¸²à¸£à¸ªà¸´à¸—à¸˜à¸´à¹Œà¹€à¸‚à¹‰à¸²à¸–à¸¶à¸‡à¸«à¸£à¸·à¸­à¸—à¸£à¸±à¸à¸¢à¸²à¸à¸£à¹ƒà¸”à¹†",
        //Size
        "2 - Developers, system administrators": "2 - à¸™à¸±à¸à¸à¸±à¸’à¸™à¸², à¸œà¸¹à¹‰à¸”à¸¹à¹à¸¥à¸£à¸°à¸šà¸š",
        "4 - Intranet users": "4 - à¸œà¸¹à¹‰à¹ƒà¸Šà¹‰à¸‡à¸²à¸™à¸ à¸²à¸¢à¹ƒà¸™",
        "5 - Partners": "5 - Partners",
        "6 - Authenticated users": "6 - à¸œà¸¹à¹‰à¹ƒà¸Šà¹‰à¸‡à¸²à¸™à¸—à¸µà¹ˆà¸•à¹‰à¸­à¸‡à¸¥à¸‡à¸—à¸°à¹€à¸šà¸µà¸¢à¸™",
        "9 - Anonymous Internet users": "9 - à¸œà¸¹à¹‰à¹ƒà¸Šà¹‰à¸‡à¸²à¸™à¸­à¸´à¸™à¹€à¸•à¸­à¸£à¹Œà¹€à¸™à¹‡à¸•à¸—à¸±à¹ˆà¸§à¹„à¸›",
        //Ease of Discovery
        "1 - Practically impossible": "1 - à¹à¸—à¸šà¸ˆà¸°à¹€à¸›à¹‡à¸™à¹„à¸›à¹„à¸¡à¹ˆà¹„à¸”à¹‰",
        "3 - Difficult": "3 - à¸¢à¸²à¸",
        "7 - Easy": "7 - à¸‡à¹ˆà¸²à¸¢",
        "9 - Automated tools available": "9 - à¸ªà¸²à¸¡à¸²à¸£à¸–à¹ƒà¸Šà¹‰à¹€à¸„à¸£à¸·à¹ˆà¸­à¸‡à¸¡à¸·à¸­à¸­à¸±à¸•à¹‚à¸™à¸¡à¸±à¸•à¸´à¹„à¸”à¹‰",
        //Ease of Exploit
        "1 - Theoretical": "1 - à¹€à¸Šà¸´à¸‡à¸—à¸¤à¸©à¸à¸µ",
        "3 - Difficult": "3 - à¸¢à¸²à¸",
        "5 - Easy": "5 - à¸‡à¹ˆà¸²à¸¢",
        "9 - Automated tools available": "9 - à¸ªà¸²à¸¡à¸²à¸£à¸–à¹ƒà¸Šà¹‰à¹€à¸„à¸£à¸·à¹ˆà¸­à¸‡à¸¡à¸·à¸­à¸­à¸±à¸•à¹‚à¸™à¸¡à¸±à¸•à¸´à¹„à¸”à¹‰",
        //Awareness
        "1 - Unknown": "1 - à¹„à¸¡à¹ˆà¹€à¸›à¹‡à¸™à¸—à¸µà¹ˆà¸£à¸¹à¹‰à¸ˆà¸±à¸",
        "4 - Hidden": "4 - à¸›à¸à¸›à¸´à¸”",
        "6 - Obvious": "6 - à¸Šà¸±à¸”à¹€à¸ˆà¸™",
        "9 - Public knowledge": "9 - à¸£à¸¹à¹‰à¹‚à¸”à¸¢à¸—à¸±à¹ˆà¸§à¹„à¸›",
        //Intrusion Detection
        "1 - Active detection in application": "1 - à¸£à¸°à¸šà¸šà¸ªà¸²à¸¡à¸²à¸£à¸–à¸•à¸£à¸§à¸ˆà¸ˆà¸±à¸šà¹„à¸”à¹‰",
        "3 - Logged and reviewed": "3 - à¸šà¸±à¸™à¸—à¸¶à¸à¹à¸¥à¸°à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸šà¹„à¸”à¹‰",
        "8 - Logged without review": "8 - à¸šà¸±à¸™à¸—à¸¶à¸à¹à¸•à¹ˆà¹„à¸¡à¹ˆà¸•à¸£à¸§à¸ˆà¸ªà¸­à¸š",
        "9 - Not logged": "9 - à¹„à¸¡à¹ˆà¸¡à¸µà¸à¸²à¸£à¸šà¸±à¸™à¸—à¸¶à¸",
        //Loss of Confidentiality
        "2 - Minimal non-sensitive data disclosed": "2 - à¹€à¸›à¸´à¸”à¹€à¸œà¸¢à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸—à¸µà¹ˆà¹„à¸¡à¹ˆà¸¥à¸°à¹€à¸­à¸µà¸¢à¸”à¸­à¹ˆà¸­à¸™à¹€à¸à¸µà¸¢à¸‡à¹€à¸¥à¹‡à¸à¸™à¹‰à¸­à¸¢",
        "6 - Minimal critical data disclosed, extensive non-sensitive data disclosed": "6 - à¹€à¸›à¸´à¸”à¹€à¸œà¸¢à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸—à¸µà¹ˆà¸¥à¸°à¹€à¸­à¸µà¸¢à¸”à¸­à¹ˆà¸­à¸™à¹€à¸à¸µà¸¢à¸‡à¹€à¸¥à¹‡à¸à¸™à¹‰à¸­à¸¢,à¹€à¸›à¸´à¸”à¹€à¸œà¸¢à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸—à¸µà¹ˆà¹„à¸¡à¹ˆà¸¥à¸°à¹€à¸­à¸µà¸¢à¸”à¸­à¹ˆà¸­à¸™à¸ˆà¸³à¸™à¸§à¸™à¸¡à¸²à¸",
        "7 - Extensive critical data disclosed": "7 - à¹€à¸›à¸´à¸”à¹€à¸œà¸¢à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸—à¸µà¹ˆà¸¥à¸°à¹€à¸­à¸µà¸¢à¸”à¸­à¹ˆà¸­à¸™à¸ˆà¸³à¸™à¸§à¸™à¸¡à¸²à¸",
        "9 - All data disclosed": "9 - à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸—à¸±à¹‰à¸‡à¸«à¸¡à¸”à¸–à¸¹à¸à¹€à¸›à¸´à¸”à¹€à¸œà¸¢",
        //Loss of Integrity
        "1 - Minimal slightly corrupt data": "1 - à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¹€à¸ªà¸µà¸¢à¸«à¸²à¸¢à¹€à¸¥à¹‡à¸à¸™à¹‰à¸­à¸¢à¹ƒà¸™à¸›à¸£à¸´à¸¡à¸²à¸“à¸™à¹‰à¸­à¸¢",
        "3 - Minimal seriously corrupt data": "3 - à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¹€à¸ªà¸µà¸¢à¸«à¸²à¸¢à¸£à¹‰à¸²à¸¢à¹à¸£à¸‡à¹ƒà¸™à¸›à¸£à¸´à¸¡à¸²à¸“à¸™à¹‰à¸­à¸¢",
        "5 - Extensive slightly corrupt data": "5 - à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¹€à¸ªà¸µà¸¢à¸«à¸²à¸¢à¹€à¸¥à¹‡à¸à¸™à¹‰à¸­à¸¢à¹ƒà¸™à¸›à¸£à¸´à¸¡à¸²à¸“à¸¡à¸²à¸",
        "7 - Extensive seriously corrupt data": "7- à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¹€à¸ªà¸µà¸¢à¸«à¸²à¸¢à¸£à¹‰à¸²à¸¢à¹à¸£à¸‡à¹ƒà¸™à¸›à¸£à¸´à¸¡à¸²à¸“à¸¡à¸²à¸",
        "9 - All data totally corrupt": "9 - à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸—à¸±à¹‰à¸‡à¸«à¸¡à¸”à¹€à¸ªà¸µà¸¢à¸«à¸²à¸¢",
        //Loss of Availability
        "1 - Minimal secondary services interrupted": "1 - Service à¸£à¸­à¸‡à¸«à¸¢à¸¸à¸”à¸—à¸³à¸‡à¸²à¸™à¹€à¸¥à¹‡à¸à¸™à¹‰à¸­à¸¢",
        "5 - Minimal primary services interrupted, extensive secondary services interrupted": "5 - Service à¸«à¸¥à¸±à¸à¸«à¸¢à¸¸à¸”à¸—à¸³à¸‡à¸²à¸™à¹€à¸¥à¹‡à¸à¸™à¹‰à¸­à¸¢, Service à¸£à¸­à¸‡à¸«à¸¢à¸¸à¸”à¸—à¸³à¸‡à¸²à¸™",
        "7 - Extensive primary services interrupted": "7 - Service à¸«à¸¥à¸±à¸à¸«à¸¢à¸¸à¸”à¸—à¸³à¸‡à¸²à¸™",
        "9 - All services completely lost": "9 - Service à¸—à¸±à¹‰à¸‡à¸«à¸¡à¸”à¸«à¸¥à¸±à¸à¸«à¸¢à¸¸à¸”à¸à¸²à¸£à¸—à¸³à¸‡à¸²à¸™",
        //Loss of Accountability
        "1 - Fully traceable": "1 - à¸ªà¸²à¸¡à¸²à¸£à¸–à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸šà¸¢à¹‰à¸­à¸™à¸à¸¥à¸±à¸šà¹„à¸”à¹‰à¹€à¸•à¹‡à¸¡à¸—à¸µà¹ˆ",
        "7 - Possibly traceable": "7 - à¸ªà¸²à¸¡à¸²à¸£à¸–à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸šà¸¢à¹‰à¸­à¸™à¸à¸¥à¸±à¸šà¹„à¸”à¹‰",
        "9 - Completely anonymous": "9 - à¹„à¸¡à¹ˆà¸ªà¸²à¸¡à¸²à¸£à¸–à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸šà¸¢à¹‰à¸­à¸™à¸à¸¥à¸±à¸šà¹„à¸”à¹‰",
        //Financial Damage
        "1 - Less than the cost to fix the vulnerability": "1 - à¸™à¹‰à¸­à¸¢à¸à¸§à¹ˆà¸²à¸„à¹ˆà¸²à¹ƒà¸Šà¹‰à¸ˆà¹ˆà¸²à¸¢à¹ƒà¸™à¸à¸²à¸£à¹à¸à¹‰à¹„à¸‚à¸Šà¹ˆà¸­à¸‡à¹‚à¸«à¸§à¹ˆ",
        "3 - Minor effect on annual profit": "3 - à¸¡à¸µà¸œà¸¥à¸à¸£à¸°à¸—à¸šà¹€à¸¥à¹‡à¸à¸™à¹‰à¸­à¸¢à¸•à¹ˆà¸­à¸œà¸¥à¸à¸³à¹„à¸£à¸›à¸£à¸°à¸ˆà¸³à¸›à¸µ",
        "7 - Significant effect on annual profit": "7 - à¸¡à¸µà¸œà¸¥à¸à¸£à¸°à¸—à¸šà¸ªà¸³à¸„à¸±à¸à¸•à¹ˆà¸­à¸œà¸¥à¸à¸³à¹„à¸£à¸›à¸£à¸°à¸ˆà¸³à¸›à¸µ",
        "9 - Bankruptcy": "9 - à¸¥à¹‰à¸¡à¸¥à¸°à¸¥à¸²à¸¢",
        //Reputation Damage
        "1 - Minimal damage": "1 - à¸„à¸§à¸²à¸¡à¹€à¸ªà¸µà¸¢à¸«à¸²à¸¢à¹€à¸¥à¹‡à¸à¸™à¹‰à¸­à¸¢",
        "4 - Loss of major accounts": "4 - à¸ªà¸¹à¸à¹€à¸ªà¸µà¸¢à¸¥à¸¹à¸à¸„à¹‰à¸²à¸£à¸²à¸¢à¹ƒà¸«à¸à¹ˆà¸‚à¸­à¸‡à¸šà¸£à¸´à¸©à¸±à¸—",
        "5 - Loss of goodwill": "5 - à¸ªà¸¹à¸à¹€à¸ªà¸µà¸¢à¸„à¸§à¸²à¸¡à¸™à¸´à¸¢à¸¡",
        "9 - Brand damage": "9 - à¸„à¸§à¸²à¸¡à¹€à¸ªà¸µà¸¢à¸«à¸²à¸¢à¸•à¹ˆà¸­à¹à¸šà¸£à¸™à¸”à¹Œ",
        //"Non-Compliance
        "2 - Minor violation": "2 - à¸à¸²à¸£à¸¥à¸°à¹€à¸¡à¸´à¸”à¹€à¸¥à¹‡à¸à¸™à¹‰à¸­à¸¢",
        "5 - Clear violation": "5 - à¸à¸²à¸£à¸¥à¸°à¹€à¸¡à¸´à¸”à¸—à¸µà¹ˆà¸Šà¸±à¸”à¹€à¸ˆà¸™",
        "7 - High profile violation": "7 - à¸à¸²à¸£à¸¥à¸°à¹€à¸¡à¸´à¸”à¸—à¸µà¹ˆà¸£à¸¸à¸™à¹à¸£à¸‡",
        //Privacy Violation
        "3 - One individual": "3 - à¸šà¸¸à¸„à¸„à¸¥à¸«à¸™à¸¶à¹ˆà¸‡à¸„à¸™",
        "5 - Hundreds of people": "5 - à¸£à¹‰à¸­à¸¢à¸„à¸™",
        "7 - Thousands of people": "7 - à¸à¸±à¸™à¸„à¸™",
        "9 - Millions of people": "9 - à¸¥à¹‰à¸²à¸™à¸„à¸™"
      }
    };

    let currentLang = 'en';

    function setLang(lang) {
      currentLang = lang;
      Object.keys(translations[lang]).forEach(key => {
        document.querySelectorAll("h2, h3, h4, option, label").forEach(el => {
          const current = el.textContent.trim();
          if (current === translations[currentLang === 'en' ? 'th' : 'en'][key] || current === key) {
            el.textContent = translations[lang][key];
          }
        });
      });
      /* Translate <option> elements for dropdowns as well
      document.querySelectorAll("option").forEach(el => {
        const current = el.textContent.trim();
        if (translations[currentLang === 'en' ? 'th' : 'en'][current]) {
          el.textContent = translations[lang][current];
        }
      });*/
    }
    </script>


<script type="text/javascript">
  function adjustScore(elm){
    elm.title = elm.value;
    globalUpdate();
    window.location.hash = getStatus();
  }
  document.getElementById("adjust").onchange = adjustScore;
  var colors = ['#8e8','#ee6','#f66']
  var scoreColors = ['#7dd','#8e8','#ee5','#f66','#c00']
  function value2text(value){
    return value < 3 ? "LOW" : (value < 6 ? "MEDIUM" : "HIGH");
  }
  function val2score(value){
    return value < 3 ? 0 : (value < 6 ? 1 : 2);
  }
  function globalUpdate(){
    var likelihood = parseFloat(document.getElementById('likelihood').textContent);
    var techimpact = parseFloat(document.getElementById('techimpact').textContent);
    var busiimpact = parseFloat(document.getElementById('busiimpact').textContent);
    var adjust = parseFloat(document.getElementById('adjust').value) / 100.0;
    var impact = ( busiimpact * adjust ) + ( techimpact * (1-adjust) )
    function score2text(score){
      return ['NOTE','LOW','MEDIUM','HIGH','CRITICAL'][score];
    }
    var score = val2score(likelihood) + val2score(impact);
    var elm = document.getElementById('risk');
    elm.textContent = score2text(score);
    elm.style.backgroundColor = scoreColors[score];
    // Update Adjust Weight display
    document.getElementById('adjustScore').textContent = `${Math.round(adjust * 100)}%`;
  }
 /* function getStatus(){
    var selects = document.querySelectorAll("select");
    var letters = "KMOZDXWLCIATFRSP";
    var vector = Array.prototype.map.call(selects,function(x,i){return letters[i]+x.value});
    vector = Array.prototype.reduce.call(vector,function(v,x,i){return v + (i%4==0 ? "/" : ":") + x});
    // vector = vector,replace(/\//g)
    var percent = parseInt(100*parseFloat(document.getElementById('adjust').value));
    return "OWASP/"+vector+"/"+percent;
  } 
*/

    function getStatus() {
    const selects = document.querySelectorAll("select");
    const fieldMap = [
    "SL", "M", "O", "S",
    "ED", "EE", "A", "ID",
    "LC", "LI", "LAV", "LAC",
    "FD", "RD", "NC", "PV"
  ];

  const vector = Array.prototype.map.call(selects, function(x, i) {
    return fieldMap[i] + ":" + x.value;
  });

  const output = vector.join("/");
  const percent = parseInt(document.getElementById('adjust').value);
  return "OWASP/"+output + "/" + percent;
}

  function clamp(num,min,max){
    return Math.min(Math.max(num, min), max);
  }
  function setStatus(status){
    var status = (status.match(/\d+/g) || []).map(function (x){return parseInt(x)});
    status = status.map(function(x,i){return clamp(x, 0, i<16 ? 9 : 100)})
    if(status.length != 17)
      status = Array(16).fill(0).concat(0);
    document.getElementById('adjust').value = status.pop() || 0;
    var selects = document.querySelectorAll("select");
    Array.prototype.map.call( selects, function(elm,index){
      elm.value = status[index];
      elm.onchange();
    });
  }
  var sections = ["likelihood",'techimpact','busiimpact'];
  sections.map(
    function(name){
      var updateFunc = function(){
        // Set background color of the select itself, not its parent
        this.style.backgroundColor = colors[ val2score(this.value) ];
        var selects = document.querySelectorAll("#tr_" + name + " select");
        var value = Math.round(Array.prototype.reduce.call( selects, function(sum,elm){
          return sum + parseInt(elm.value);
        },0) * 10 / selects.length) / 10.0;
        var elm = document.getElementById(name);
        elm.textContent = value.toFixed(1);
        // Conditional coloring for likelihood, techimpact, and busiimpact
        if (["likelihood", "techimpact", "busiimpact"].includes(name)) {
          elm.classList.remove("text-green-300", "text-yellow-300", "text-red-400");
          if (value < 3.0) {
            elm.classList.add("text-green-300");
          } else if (value < 6.0) {
            elm.classList.add("text-yellow-300");
          } else {
            elm.classList.add("text-red-400");
          }
        }
        var labelElm = document.getElementById(name + "-label");
        if (labelElm) {
          labelElm.textContent = value2text(value);
        }
        globalUpdate();
        var status = getStatus();
        document.getElementById('vector').textContent = status;
        window.location.hash = status;
      };
      var selects = document.querySelectorAll("#tr_"+name+" select");
      Array.prototype.map.call( selects, function(elm){
        elm.onchange = updateFunc;
      });
    }
  );
  setStatus(window.location.hash);
  window.onhashchange = function(){setStatus(window.location.hash)};
  window.onload = function(){
    var selects = document.querySelectorAll("select");
    Array.prototype.map.call(selects, function(x){
      var td = x.parentNode;
      var tr = td.parentNode;
      var i = Array.prototype.indexOf.call(tr.children,td);
      var th = tr.previousElementSibling.children[i];
      th.title = x.title;
    });
  }
  document.getElementById('vector').onpaste = function(ev){
  	var vector = ev.clipboardData.getData('text')
  	setStatus(vector);
  	return ev.preventDefault();
  }
  // Copy vector functionality
  document.getElementById('copyVectorBtn').addEventListener('click', function () {
    const vectorText = document.getElementById('vector').textContent;
    navigator.clipboard.writeText(vectorText).then(() => {
      alert('Vector copied to clipboard!');
    }).catch(err => {
      alert('Failed to copy vector: ' + err);
    });
  });
</script>

</body>
</html>